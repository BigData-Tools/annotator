<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <title>Annotator demo</title>

    <script src="lib/vendor/jquery.js"></script>
    <script src="lib/vendor/showdown.js"></script>
    <script src="lib/xpath.js"></script>
    <script src="lib/util.js"></script>
    <script src="lib/console.js"></script>
    <script src="lib/class.js"></script>
    <script src="lib/range.js"></script>
    <script src="lib/annotator.js"></script>
    <script src="lib/widget.js"></script>
    <script src="lib/editor.js"></script>
    <script src="lib/viewer.js"></script>
    <script src="lib/notification.js"></script>
    <script src="lib/plugin/permissions.js"></script>
    <script src="lib/plugin/annotateitpermissions.js"></script>
    <script src="lib/plugin/auth.js"></script>
    <script src="lib/plugin/filter.js"></script>
    <script src="lib/plugin/kitchensink.js"></script>
    <script src="lib/plugin/markdown.js"></script>
    <script src="lib/plugin/store.js"></script>
    <script src="lib/plugin/tags.js"></script>
    <script src="lib/plugin/unsupported.js"></script>


    <link rel="stylesheet" type="text/css" href="css/annotator.css">

    <style>
      body {
        margin: 1em 0;
        padding: 0;
        font-family: "Helvetica Neue", Helvetica, sans-serif;
      }
      #controls, #content {
        margin: 0 10%;
      }
      #controls #editor {
        width: 80%;
        height: 32px;
        font-size: 16px;
        font-family: "PragmataPro";
        line-height: 16px;
      }
      #controls button.submit {
        font-size: 14px;
        margin: 10px 0 0 0;
        padding: 0.5em;
        display: block;
      }
      #controls dl {
        margin: 0 0 1em 0;
        padding: 0;
      }
      #controls dl dt {
        padding: 0.7em 0.5em;
        display: inline-block;
        border: 1px solid #aaa;
        cursor: pointer;
      }
      #controls dl dt:hover {
        background: rgb(106, 154, 202);
        color: #fff;
      }
      #controls dl dt.active {
        font-weight: bold;
      }
      #controls dl dd {
        display: none;
      }
    </style>

  </head>

  <body>
    <div id="controls">
      <form id="demo" action="">
        <dl>
          <dt>start</dt>
          <dd>
$('#content').annotator();
          </dd>
          <dt>plugins</dt>
          <dd>
$('#content').annotator()
             .annotator('addPlugin', 'Tags');
          </dd>
          <dt>store</dt>
          <dd>
$('#content').annotator()
             .annotator('addPlugin', 'Tags')
             .annotator('addPlugin', 'Store', {
                          prefix: 'http://localhost:5200',
                        });
          </dd>
          <dt>kitchensink</dt>
          <dd>
$('#content').annotator()
             .annotator('setupPlugins');
          </dd>
        </dl>
        <div id="editor"></div>
        <!-- <textarea></textarea> -->
        <button class=submit>Update &raquo;</button>
      </form>
    </div>

    <div id="content">
      <a id="SimpleAnnotations" name="SimpleAnnotations"></a>
      <h2>Open Annotation Core</h2>

      <p>
        In general terms, an Annotation expresses the relationship between two or more resources, and their metadata, using an RDF graph.
        The Open Annotation Core framework explains how to identify and describe the related resources,
        and how to provide information concerning the creation and intent of the Annotation.
      </p>

      <a id="BodyTarget" name="BodyTarget"></a>
      <h3>Body and Target Resources</h3>
      <p>
        Typically an Annotation has a single Body, which is the comment or other descriptive resource, and a single Target that the Body is somehow "about".
        The Body provides the information which is annotating the Target.
        This "aboutness" may be further clarified or extended to notions such as classifying or identifying, discussed in more detail in the section on <a href="#Motivations">Motivations</a>.
      </p>

      <p>
        The Body and Target may be of any media type, and contain any type of content.  The Body and Target SHOULD be
        identified by HTTP URIs unless they are <a href="#BodyEmbed">embedded</a> within the Annotation.</p>

      <p>
        All Annotations MUST be instances of the class <code class="tech">oa:Annotation</code>,
        and additional subclassing is ONLY RECOMMENDED in order to provide additional, community-specific constraints on the model.
        The model does not define classes for Body and Target, as the Body of one Annotation may be the Target of another,
        and thus the classes would not convey any usable information.
        Instead, typing based on the <a href="#BodyTargetType">resource content</a> is RECOMMENDED.
      </p>

      <p>
        The model defines two relationships, <code class="tech">oa:hasBody</code> and <code class="tech">oa:hasTarget</code>,
        to associate the Body and Target resources, respectively, with the Annotation.
      </p>

      <h4>Model</h4>

      <blockquote>
        <table>
          <tr><th>Vocabulary Item</th><th>Type</th><th>Description</th></tr>
          <tr><td>oa:Annotation</td><td>Class</td><td>The class for Annotations
              <br/>The oa:Annotation class MUST be associated with an Annotation.</td></tr>
          <tr><td>oa:hasBody</td><td>Relationship</td><td>The relationship between an Annotation and the Body of the Annotation
              <br/>There SHOULD be 1 or more oa:hasBody relationships associated with an Annotation but there MAY be 0.
          </td></tr>
          <tr><td>oa:hasTarget</td><td>Relationship</td><td>The relationship between an Annotation and the Target of the Annotation
              <br/>There MUST be 1 or more oa:hasTarget relationships associated with an Annotation.
          </td></tr>
        </table>
      </blockquote>
    </div>

    <script src="ace/ace.js" type="text/javascript" charset="utf-8"></script>
    <script src="ace/keybinding-vim.js" type="text/javascript" charset="utf-8"></script>
    <script>
      jQuery(function ($) {

        var editorContainer = $("#editor");
        var editor = ace.edit("editor");
        editor.setKeyboardHandler(ace.require("ace/keyboard/vim").handler);
        editor.getSession().setMode("ace/mode/javascript");

        var autosize = function () {
          var h = (editor.getSession().getScreenLength() + 1)
                  * editor.renderer.lineHeight
                  + editor.renderer.scrollBar.getWidth();
          editorContainer.height(h);
          //editorContainer.find(':first-child').height(h);
          editor.resize(true);
        };

        editor.getSession().on('change', autosize);

        var setval = function (value) {
          editor.setValue(value);
          editor.navigateFileEnd();
        };

        var evil = function () {
          eval(editor.getValue());
        };

        $("#controls").on('click', 'dt', function () {
          window.location.hash = '#' + $(this).text().trim();
          setval($(this).next('dd').text().trim());
          $('#controls form').submit();
        });

        $("#controls").on('submit', 'form', function (e) {
          e.preventDefault();
          $.each(Annotator._instances.slice(0), function () {
            this.destroy();
          });
          evil();
        });

        $('#content').on('click', '.annotator-hl', function () {
          console.debug($(this).data());
        });

        // Load state from location.hash
        $('#controls dt').each(function () {
          if ('#' + $(this).text().trim() === window.location.hash) {
            setval($(this).next('dd').text().trim());
            evil();
          }
        });

      });
    </script>
  </body>


</html>
